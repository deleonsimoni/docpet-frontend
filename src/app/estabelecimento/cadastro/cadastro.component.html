<form [formGroup]="estabelecimentoForm" (ngSubmit)="salvar()">
  <!-- Basic Information -->
  <div class="card">
    <div class="card-body">
        <h4 class="card-title">Informações</h4>
        <div class="row form-row">
            <div class="col-md-6">
                <div class="form-group">
                    <label>CNPJ<span class="text-danger">*</span></label>
                    <input type="text" class="form-control" #cnpj formControlName="cnpj" mask="00.000.000/0000-00">
                    <app-mensagem *ngIf="
                      estabelecimentoForm.get('cnpj')?.errors?.required &&
                      estabelecimentoForm.get('cnpj')?.touched"
                      mensagem="CNPJ é obrigatório">
                    </app-mensagem>
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group">
                    <label>Nome<span class="text-danger">*</span></label>
                    <input type="text" class="form-control" formControlName="nome" [readonly]="!cnpj.value">
                    <app-mensagem
                      *ngIf="
                      estabelecimentoForm.get('nome')?.errors?.required &&
                      estabelecimentoForm.get('nome')?.touched
                      "
                      mensagem="O nome é obrigatório"
                    ></app-mensagem>
                </div>
            </div>
            <div class="col-md-12">
              <div class="form-group">
                  <label>Especialidade</label>
                  <ng-select [multiple]="true" formControlName="especialidades">
                    <ng-option *ngFor="let espc of listaEspecialidade" [value]="espc._id">{{espc.nome}}</ng-option>
                    <!--<ng-option [value]="'custom'">Custom</ng-option> -->
                  </ng-select>
              </div>
            </div>
            <div class="col-md-2">
              <div class="form-group mb-0">
                <div class="status-toggle">
                  <input type="checkbox" id="isStatus" name="status" formControlName="status" class="check" checked> Status
                  <label for="isStatus" class="checktoggle">Status</label>
                </div>
              </div>
            </div>
            <div class="col-md-2">
                <div class="form-group mb-0">
                  <div id="isVeterinario_select">
                    <div class="status-toggle">
                      <input type="checkbox" id="isVeterinario" name="checkIsVeterinario" #checkIsVeterinario [checked]="isVeterinario"  class="check"> Veterinário
                      <label for="isVeterinario" class="checktoggle">Veterinário</label>
                    </div>
                  </div>
                </div>
            </div>
            <div class="col-md-2">
              <div id="customIsPlanoSaude" [hidden]="!checkIsVeterinario.checked">
                <div class="form-group">
                  <div class="status-toggle">
                    <input type="checkbox" id="isPlanoSaude" class="check" name="atendePlano" formControlName="atendePlano">Plano de Saúde
                    <label for="isPlanoSaude" class="checktoggle">Plano de Saúde</label>
                  </div>
                </div>
              </div>
          </div>

        </div>
    </div>
  </div>
  <!-- /Basic Information -->
  <!-- Contato -->
  <div class="card">
    <div class="card-body">
        <h4 class="card-title">Contato</h4>
        <div class="row form-row" formGroupName="contato">
            <div class="col-md-6">
                <div class="form-group">
                    <label>Nome<span class="text-danger">* </span></label>
                    <input type="text" class="form-control" formControlName="nome">
                    <app-mensagem *ngIf="
                      estabelecimentoForm.get('contato')?.get('nome')?.errors?.required &&
                      estabelecimentoForm.get('contato')?.get('nome')?.touched"
                      mensagem="Nome é obrigatório">
                    </app-mensagem>
                </div>
            </div>
            <div class="col-md-6">
              <div class="form-group">
                  <label>Email <span class="text-danger">*</span></label>
                  <input type="email" class="form-control" formControlName="email">
                  <app-mensagem *ngIf="
                    estabelecimentoForm.get('contato')?.get('email')?.errors?.required &&
                    estabelecimentoForm.get('contato')?.get('email')?.touched"
                    mensagem="E-mail é obrigatório">
                  </app-mensagem>
                  <app-mensagem
                  *ngIf="
                    estabelecimentoForm.get('contato')?.get('email')?.errors?.email &&
                    estabelecimentoForm.get('contato')?.get('email')?.touched
                  "
                  mensagem="E-mail no formato incorreto"
                  >
                  </app-mensagem>
              </div>
          </div>
            <div class="col-md-6">
                <div class="form-group">
                    <label>Telefone</label>
                    <input type="text" class="form-control" formControlName="telefone" mask="(00) 0000-0000" placeholder="(00) 0000-0000">
                </div>
            </div>
            <div class="col-md-6">
              <div class="form-group">
                  <label>Celular</label>
                  <input type="text" class="form-control"  formControlName="celular" mask="(00) 00000-0000" placeholder="(00) 00000-0000">
              </div>
          </div>
        </div>
    </div>
  </div>
  <!-- /Contato-->
  <!-- Endereço -->
  <div class="card">
    <div class="card-body">
        <h4 class="card-title">Endereço</h4>
        <div class="row form-row" formGroupName="endereco">
          <div class="col-md-2">
            <div class="form-group">
                <label>CEP<span class="text-danger">*</span></label>
                <input type="text" class="form-control" formControlName="cep" mask="00000-000">
                <app-mensagem *ngIf="
                  estabelecimentoForm.get('endereco')?.get('cep')?.errors?.required &&
                  estabelecimentoForm.get('endereco')?.get('cep')?.touched"
                  mensagem="CEP é obrigatório">
              </app-mensagem>
            </div>
          </div>
          <div class="col-md-1">
            <div class="form-group">
              <label></label>
              <div class="btn-search">
                <button type="button" class="btn btn-block" style="margin-top: 7px; width: 45px;" (click)="buscarCEP(estabelecimentoForm.get('endereco')?.get('cep')?.value)"><i class="fas fa-search"></i></button>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="form-group">
                <label>Logradouro<span class="text-danger">*</span></label>
                <input type="text" class="form-control" formControlName="logradouro" readonly>
                <app-mensagem *ngIf="
                  estabelecimentoForm.get('endereco')?.get('logradouro')?.errors?.required &&
                  estabelecimentoForm.get('endereco')?.get('logradouro')?.touched"
                  mensagem="Logradouro é obrigatório">
              </app-mensagem>
            </div>
          </div>
          <div class="col-md-1">
            <div class="form-group">
                <label>N°<span class="text-danger">*</span></label>
                <input type="text" class="form-control" formControlName="numero">
                <app-mensagem *ngIf="
                  estabelecimentoForm.get('endereco')?.get('numero')?.errors?.required &&
                  estabelecimentoForm.get('endereco')?.get('numero')?.touched"
                  mensagem="Numero é obrigatório">
                </app-mensagem>

            </div>
          </div>
          <div class="col-md-4">
            <div class="form-group">
                <label>Complemento<span class="text-danger">*</span></label>
                <input type="text" class="form-control" formControlName="complemento">
            </div>
          </div>
          <div class="col-md-4">
            <div class="form-group">
                <label>Bairro<span class="text-danger">*</span></label>
                <input type="text" class="form-control" formControlName="bairro" readonly>
                <app-mensagem *ngIf="
                  estabelecimentoForm.get('endereco')?.get('bairro')?.errors?.required &&
                  estabelecimentoForm.get('endereco')?.get('bairro')?.touched"
                  mensagem="Bairro é obrigatório">
                </app-mensagem>
            </div>
          </div>
          <div class="col-md-4">
            <div class="form-group">
                <label>Município<span class="text-danger">*</span></label>
                <input type="text" class="form-control" formControlName="municipio" readonly>
                <app-mensagem *ngIf="
                  estabelecimentoForm.get('endereco')?.get('municipio')?.errors?.required &&
                  estabelecimentoForm.get('endereco')?.get('municipio')?.touched"
                  mensagem="Nunicipio é obrigatório">
                </app-mensagem>
            </div>
          </div>
          <div class="col-md-4">
            <div class="form-group">
                <label>Estado<span class="text-danger">*</span></label>
                <input type="text" class="form-control" formControlName="estado" readonly>
                <app-mensagem *ngIf="
                  estabelecimentoForm.get('endereco')?.get('estado')?.errors?.required &&
                  estabelecimentoForm.get('endereco')?.get('estado')?.touched"
                  mensagem="Estado é obrigatório">
                </app-mensagem>
            </div>
          </div>
      </div>
    </div>
    <agm-map *ngIf="showMap" [latitude]="lat" [zoom]="15" [longitude]="lng">
      <agm-marker [latitude]="lat" [longitude]="lng"></agm-marker>
    </agm-map>
  </div>
  <!-- Contato -->
  <div class="card" id="customInfoVeterinario" [hidden]="!checkIsVeterinario.checked">
    <div class="card-body">
        <h4 class="card-title">Veterinário</h4>
        <div class="veterinario-info" formArrayName="veterinarios"
        *ngFor="let veterinario of estabelecimentoForm.get('veterinarios')['controls']; let i = index;">
          <div class="row form-row veterinario-cont" [formGroupName]="i">
              <div class="col-md-2">
                <div class="form-group">
                    <label>crmv<span class="text-danger">*</span></label>
                    <input #crmv type="text" class="form-control" formControlName="crmv" placeholder="CRMV" (change)="findVet(i)" >
                </div>
              </div>
              <div class="col-md-8">
                  <div class="form-group">
                      <label>Nome<span class="text-danger">*</span></label>
                      <input type="text" class="form-control" formControlName="nome" placeholder="Nome" [readonly]="!crmv.value">
                  </div>
              </div>


            <div class="col-12 col-md-2 col-lg-1"  *ngIf="i != 0">
                <label class="d-md-block d-sm-none d-none">&nbsp;</label>
                <a href="javascript:void(0);" (click)="removeVeterinario(i)" class="btn btn-danger trash"><i class="far fa-trash-alt"></i></a>
            </div>
          </div>
        </div>
        <div class="add-more">
          <a href="javascript:void(0);" (click)="addVeterinario()" class="add-veterinario"><i class="fa fa-plus-circle"></i> Add More</a>
        </div>
    </div>
  </div>
  <!-- /Contato-->
  <div class="card">
    <div class="card-body">
      <div class="row form-row">
        <div class="submit-section submit-btn-bottom">
          <button type="submit" [class]="estabelecimentoForm.invalid ? 'btn submit-btn btn-light' : 'btn submit-btn btn-primary'">Salvar</button>
        </div>
      </div>
    </div>
  </div>
</form>
